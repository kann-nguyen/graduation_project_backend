import {
  addResolution,
  approveResolution,
  getResolution,
  getResolveProgress,
} from "../controllers/vulnerability.controller";
import express from "express";
import { checkAuth, checkSecurityExpert, checkManagerOrSecurityExpert } from "../middlewares/auth";

const vulnRoute = express.Router();

// Read-only routes available to all authenticated users
vulnRoute.get("/progress", checkAuth, getResolveProgress);
vulnRoute.get("/resolution", checkAuth, getResolution);

// Routes that require security expert or manager permissions
vulnRoute.patch("/resolution", checkAuth, checkManagerOrSecurityExpert, addResolution);
vulnRoute.patch("/resolution/approve", checkAuth, checkManagerOrSecurityExpert, approveResolution);

export default vulnRoute;
